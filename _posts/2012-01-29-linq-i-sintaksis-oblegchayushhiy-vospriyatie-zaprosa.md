---
id: 1053
title: 'LINQ и синтаксис, облегчающий восприятие запроса'
date: '2012-01-29T14:16:29+00:00'
author: serge
layout: post
guid: 'http://sotnyk.com/?p=1053'
permalink: /2012/01/29/linq-i-sintaksis-oblegchayushhiy-vospriyatie-zaprosa/
---

![](http://localhost/wp-content/uploads/2012/01/LINQ-300x117.jpg "LINQ")Попалась мне в руки книга, являющаяся введением в LINQ-запросы – “LINQ. Карманный справочник”, Джозеф и Бен Албахари. Книга достойная – кратко и понятно объяснены многие вещи. В общем, если у вас еще LINQ не захардкожен в мозгах, рекомендую. Но эта же книга навела меня на определенные размышления по поводу варианта запроса, названного как “синтаксис, облегчающий восприятие запроса”.

На всякий случай, для тех, кто не работает с C#, поясню, что это. В C# версии 3.0, ввели мощный механизм, позволяющий работать с запросами к разного рода последовательностям элементов. Это могут быть как коллекции, находящиеся в памяти, так и данные, хранящиеся в базе данных. Для работы, фильтрации и т.п. широко используются так называемые лямбда-выражения. Это небольшие куски кода, которые удобно передавать в качестве параметров. В случае если выражение передается внешнему источнику данных (тот же SQL-сервер), неявно для кодировщика, задействуется мощный механизм разбора передаваемых выражений, поэтому тот, кто, в конце концов, выполнит запрос, может превратить его в запрос уже в своем синтаксисе.  
  
И для этого мощного и удобного механизма придумали 2 синтаксиса. Первый – обычный, вполне вписывающийся в рамки обычного синтаксиса C#. Выглядит он так:  
\[csharp\]  
var query = names  
 .Where(n =&gt; n.Contains(“a”))  
 .OrderBy(n =&gt; n.Length)  
 .Select(n =&gt; n.ToUpper());  
\[/csharp\]  
Второй – совершенно новый для C# синтаксис, название которого вынесено в заголовок поста. Вот эквивалент предыдущего примера:  
\[csharp\]  
var query =  
 from n in names  
 where n.Contains(“a”)  
 orderby n.Length  
 select n.ToUpper();  
\[/csharp\]  
Этот запрос транслируется компилятором в совершенно идентичный первому примеру код.

Теперь мои мысли по этому поводу. Проще ли это понять? Мне нет. Мне удобнее использовать те же конструкции, что я использую в остальном коде. Т.е., обычный синтаксис методов. Новый синтаксис явно ввели с претензией на близость к SQL, но он все равно не совпадает с ним. Очень даже не совпадает. Только ключевые слова те же, но идут они в другом порядке, а уж в самих подвыражениях используется как раз синтаксис C#, а не какие ни IS NOT NULL и т.п. Так что тем, кто думает на SQL, таки нужно будет перестраиваться. А некоторые вещи в принципе требуют перехода в синтаксис методов.

Таким образом, думаю, что “облегченный” синтаксис вводили зря. Усложнили язык без особой надобности, упрощения восприятия (с моей точки зрения) никакого не достигли. А теперь, читая программы, нужно разбираться и в этом синтаксисе, поскольку его вполне может использовать твой коллега или кто-то еще. Компилятор же теперь обречен на поддержку этого синтаксиса в будущих версиях. Так что считаю введение этого синтаксиса ошибкой. Мнение, конечно, личное.

А вот книжка – хорошая, хоть и устаревшая слегка уже.